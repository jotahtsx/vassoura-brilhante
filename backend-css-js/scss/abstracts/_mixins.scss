@use "sass:map";
@use "variables" as *;
@use "../layout/breakpoints" as *;

//Criando grid e colunas
@mixin grid($total, $number) {
    flex: 0 0 calc(100% / (#{$total} / #{$number}));
    max-width: calc(100% / (#{$total} / #{$number}));
}

//Criando offset grids
@mixin offset-grid($total-cols, $responsive) {
    @if $responsive {
        @each $break, $value in $containers {
            @include respond(#{$break}) {
                @for $i from 1 through $total-cols {
                    .vsb-offset-#{$break}-#{$i} {
                        @if $i == $total-cols {
                            margin-left: 0;
                            flex: 0 0 100%;
                            max-width: 100%;
                        } @else {
                            margin-left: calc(100% / (#{$total-cols} / #{$i}));
                            flex: 0 0 calc(100% * ((#{$total-cols} - #{$i}) / #{$total-cols}));
                            max-width: calc(100% * ((#{$total-cols} - #{$i}) / #{$total-cols}));
                        }
                    }
                }
            }
        }
    } @else {
        @for $i from 1 through $total-cols {
            .vsb-offset-#{$i} {
                @if $i == $total-cols {
                    margin-left: 0;
                    flex: 0 0 100%;
                    max-width: 100%;
                } @else {
                    margin-left: calc(100% / (#{$total-cols} / #{$i}));
                    flex: 0 0 calc(100% * ((#{$total-cols} - #{$i}) / #{$total-cols}));
                    max-width: calc(100% * ((#{$total-cols} - #{$i}) / #{$total-cols}));
                }
            }
        }
    }
}

@mixin loop-list-property($property, $value, $important) {
    @if type-of($property) == list {
        @each $curr-property in $property {
            #{$curr-property}: #{$value} if($important, !important, unquote(""));
        }
    } @else {
        #{$property}: #{$value} if($important, !important, unquote(""));
    }
}

//Loop simples (or 1-dimensão dos mapas)
@mixin loop-through-map($map, $base-class: "vsb-", $suffix: null, $property: null, $responsive: true, $important: true) {
    @each $child, $value in $map {
        @if $value != null {

            @if $base-class == null {
                //Criando o seletor
                #{$child} {
                    @include loop-list-property($property, $value, $important);
                }
            } @else {
               //Selecionando as classes
               .#{$base-class}#{$child}#{$suffix} {
                @include loop-list-property($property, $value, $important);
               }
            }  
        }
    }

    @if $responsive {
        //Criando o loop sobre breakpoints
        @each $break, $value in $breakpoints-up {
            @include respond(#{$break}) {
                //Loop através do mapa original dos breakpoints
                @each $child, $value in $map {
                    @each $child, $value in $map {
                        @if $value != null {
                
                            @if $base-class == null {
                                //Criando o seletor
                                #{$child} {
                                    @include loop-list-property($property, $value, $important);
                                }
                            } @else {
                               //Selecionando as classes
                               .#{$base-class}#{$child}#{$suffix}-#{$break} {
                                @include loop-list-property($property, $value, $important);
                               }
                            }  
                        }
                    }
                }
            }
        }
    }
}